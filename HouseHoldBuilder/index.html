<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="utf-8">
        <title>Household builder</title>
        <style>
            .debug {
                font-family: monospace;
                border: 1px solid black;
                padding: 10px;
                display: none;
            }
        </style>
    </head>
    <body>
        <h1>Household builder</h1>
        <div class="builder">
            <ol class="household"></ol>
            <form>
                <div>
                    <label>Age
                        <input type="text" name="age">
                    </label>
                </div>
                <div>
                    <label>Relationship
                        <select name="rel">
                            <option value="">---</option>
                            <option value="self">Self</option>
                            <option value="spouse">Spouse</option>
                            <option value="child">Child</option>
                            <option value="parent">Parent</option>
                            <option value="grandparent">Grandparent</option>
                            <option value="other">Other</option>
                        </select>
                    </label>
                </div>
                <div>
                    <label>Smoker?
                        <input type="checkbox" name="smoker">
                    </label>
                </div>
                <div>
                    <button class="add">add</button>
                </div>
                <div>
                    <button type="submit">submit</button>
                </div>
            </form>
        </div>
        <pre class="debug"></pre>
        <script>

            function removeError () {
                var error = document.getElementById('error');
                if (error) {
					
                    var parent = error.parentNode;
                    parent.removeChild(error);
                }
            }
			

			
				
            function removeAllChildren(node) {
                while (node.hasChildNodes()) {
                    node.removeChild(node.lastChild);
                }
            }
			
			
        function validateForm(event) {
                event.preventDefault();
                var ageOfMember = document.getElementsByName('age')[0].value;
                var relationOfMember = document.getElementsByName('rel')[0].value;
                if (familyMembers.length) 
				{
                    var debug = document.getElementsByClassName('debug')[0];
                    var paragraph = document.createElement('p');
                    var household = document.getElementsByClassName('household')[0];
                    paragraph.innerHTML = JSON.stringify(familyMembers, null, 4);
                    removeAllChildren(debug);
                    removeAllChildren(household);
                    debug.appendChild(paragraph);
                    familyMembers = [];
                } 
			else if (!ageOfMember || !relationOfMember) 
				{
					
					var newNode = document.createElement('p');
                	newNode.id = 'error';
					newNode.innerHTML = 'Age and Relationship are both invalid';
					alert(newNode.innerHTML);
                    
                } 
            }

            function removeMember(event) {
                var id = parseInt(event.target.value)   ;
                var member = event.target.parentNode;
                var parent = member.parentNode;
                parent.removeChild(member);
                for (var i = 0; i < householdMembers.length; i++) {
                    if (familyMembers[i].id === id) {
                        familyMembers.splice(i, 1);
                    }
                }
            }
			
			
			
            function addMember(event) {
                event.preventDefault();
                var ageOfMember = document.getElementsByName('age')[0].value;
                var relationOfMember = document.getElementsByName('rel')[0].value;
                var smoker =  document.getElementsByName('smoker')[0].checked;
				   if (smoker){
						smoker = 'Smoker';
                	} else {
						smoker =  'Non-Smoker';
                	}
				if (ageOfMember > 0 && !!relationOfMember)
					{
						
								removeError();
                    			var household = document.getElementsByClassName('household')[0];
								var listItem = document.createElement('li');
								var checkbox = document.createElement('input');
								checkbox.type = 'checkbox';
								checkbox.value = id;

								listItem.innerHTML = '	Age: ' + ageOfMember + 
													 '  Relationship: ' + relationOfMember+ 
													 '  Smoker?: ' + smoker + 
													 ' <strong>Delete?</strong> ';
								checkbox.addEventListener('click', removeMember);
								listItem.appendChild(checkbox);
								household.appendChild(listItem);
							window.console.log("here i am ");
								storeMember(ageOfMember, relationOfMember, smoker);
								//remove After clicking Sumbit
								document.getElementsByName('age')[0].value = '';
								document.getElementsByName('rel')[0].value = '';
						
					}
				else
					{
						validateForm(event);	
					}
            }
			
			
            function storeMember(age, rel, smoker) {
                var info = {};
                info['age'] = age;
                info['rel'] = rel;
                info['smoker'] = smoker;
                info['id'] = id++;
                familyMembers.push(info);
            }
            var form = document.querySelector('form');
            var addBtn = document.getElementsByClassName('add')[0];
            var familyMembers = [];
            var id = 1;
            form.addEventListener('submit', validateForm);
            addBtn.addEventListener('click', addMember)
			
			
			
			
        </script>
    </body>
</html>
